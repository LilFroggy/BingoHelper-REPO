{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Guide Schema",
    "description": "The schema that is actually used to validate guides. Differs from guide_creation_schema.json in that it does not have example bloat.",
    "type": "object",
    "properties": {
        "name": { "type": "string" },
        "version": { "type": "integer" },
        "data": { "type": "object",
            "properties": {
                "stepIndex": { "type": "integer" },
                "steps": { "type": "array",
                    "items": { "type": "object",
                        "properties": {
                            "type": { "$ref": "#/definitions/StepTypes" },
                            "instruction": { "type": "string" },
                            "command": { "type": "string" },
                            "clientCommand": { "type": "string" },
                            "waypoint": { "$ref": "#/definitions/WaypointProperty" },
                            "outlineEntity": { "$ref": "#/definitions/OutlineEntityProperty" }
                        },
                        "oneOf": [
                            { "$ref": "#/definitions/MessageStep" },
                            { "$ref": "#/definitions/CakeStep" },
                            { "$ref": "#/definitions/SellStep" },
                            { "$ref": "#/definitions/BuyStep" },
                            { "$ref": "#/definitions/HasStep" },
                            { "$ref": "#/definitions/AreaStep" },
                            { "$ref": "#/definitions/SubAreaStep" },
                            { "$ref": "#/definitions/EnchantStep" },
                            { "$ref": "#/definitions/ReforgeStep" },
                            { "$ref": "#/definitions/GuiItemStep" },
                            { "$ref": "#/definitions/GuiClickSlotStep" },
                            { "$ref": "#/definitions/SkillStep" },
                            { "$ref": "#/definitions/CollectionStep" },
                            { "$ref": "#/definitions/StoreStep" },
                            { "$ref": "#/definitions/RetrieveStep" },
                            { "$ref": "#/definitions/ExperienceStep" }
                        ],
                        "required": [
                            "type",
                            "instruction"
                        ]
                    }
                }
            },
            "required": [
                "stepIndex",
                "steps"
            ]
        }
    },
    "required": [
        "name",
        "version",
        "data"
    ],
    "definitions": {
        "WaypointProperty": {
            "properties": {
                "type": { "const": "list" },
                "beam": { "type": "boolean" },
                "list": { "type": "array",
                    "items": { "type": "object",
                        "properties": {
                            "text": { "type": "string" },
                            "position": { "type": "array",
                                "items": { "type": "number" },
                                "minItems": 3,
                                "maxItems": 3
                            },
                            "radius": { "type": "integer" }
                        },
                        "required": [
                            "text",
                            "position",
                            "radius"
                        ]
                    }
                },
                "index": { "type": "integer" }
            },
            "required": [
                "type",
                "beam",
                "list",
                "index"
            ]
        },
        "OutlineEntityProperty": {
            "properties": {
                "entityType": { "type": "string" },
                "position": { "type": "array",
                    "items": { "type": "number" },
                    "minItems": 3,
                    "maxItems": 3
                }
            },
            "required": [
                "entityType",
                "position"
            ]
        },
        "StepTypes": {
            "enum": [
                "message",
                "cake",
                "sell",
                "buy",
                "has",
                "area",
                "subArea",
                "enchant",
                "reforge",
                "guiItem",
                "guiClickSlot",
                "skill",
                "collection",
                "store",
                "retrieve",
                "experience"
            ]
        },
        "MessageStep": {
            "properties": {
                "type": { "const": "message" },
                "criteria": { "type": "string" }
            },
            "required": [
                "criteria"
            ]
        },
        "CakeStep": {
            "properties": {
                "type": { "const": "cake" },
                "eaten": {
                    "type": "array",
                    "items": { "type": "string" }
                }
            },
            "required": [
                "eaten"
            ]
        },
        "SellStep": {
            "properties": {
                "type": { "const": "sell" },
                "items": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/ItemIds" }
                }
            },
            "required": [
                "items"
            ]
        },
        "BuyStep": {
            "properties": {
                "type": { "const": "buy" },
                "items": { "type": "object",
                    "propertyNames": {
                        "$ref": "#/definitions/ItemIds"
                    },
					"additionalProperties": {
                        "type": "object",
                        "properties": {
                            "count": { "type": "integer" },
                            "target": { "type": "integer" },
                            "done": { "type": "boolean" }
                        },
                        "required": [
                            "count",
                            "target",
                            "done"
                        ]
                    }
                }
            },
            "required": [
                "items"
            ]
        },
        "HasStep": {
            "properties": {
                "type": { "const": "has" },
                "items": { "type": "object",
                "propertyNames": {
                        "$ref": "#/definitions/ItemIds"
                    },
					"additionalProperties": {
                        "type": "object",
                        "properties": {
                            "count": { "type": "integer" },
                            "target": { "type": "integer" },
                            "done": { "type": "boolean" }
                        },
                        "required": [
                            "count",
                            "target",
                            "done"
                        ]
                    }
                }
            },
            "required": [
                "items"
            ]
        },
        "AreaStep": {
            "properties": {
                "type": { "const": "area" },
                "area": { "$ref": "#/definitions/Area" }
            },
            "required": [
                "area"
            ]
        },
        "SubAreaStep": {
            "properties": {
                "type": { "const": "subArea" },
                "subArea": { "$ref": "#/definitions/SubArea" }
            },
            "required": [
                "subArea"
            ]
        },
        "EnchantStep": {
            "properties": {
                "type": { "const": "enchant" },
                "items": { "type": "object",
                    "propertyNames": {
                        "$ref": "#/definitions/ItemIds"
                    },
					"additionalProperties": {
                        "type": "object",
                        "properties": {
                            "enchants": { "type": "array",
                                "items": { "$ref": "#/definitions/Enchants" }
                            },
                            "done": { "type": "boolean" }
                        },
                        "required": [
                            "enchants",
                            "done"
                        ]
                    }
                }
            },
            "required": [
                "items"
            ]
        },
        "ReforgeStep": {
            "properties": {
                "type": { "const": "reforge" },
                "items": { "type": "object",
                    "propertyNames": {
                        "$ref": "#/definitions/ItemIds"
                    },
					"additionalProperties": {
                        "type": "object",
                        "properties": {
                            "reforges": { "type": "array",
                                "items": { "$ref": "#/definitions/Reforges" }
                            },
                            "done": { "type": "boolean" }
                        },
                        "required": [
                            "reforges",
                            "done"
                        ]
                    }
                }
            },
            "required": [
                "items"
            ]
        },
        "GuiItemStep": {
            "properties": {
                "type": { "const": "guiItem" },
                "guiName": { "type": "string" },
                "itemIndex": { "type": "integer" },
                "has": { "type": "string" },
                "doesntHave": { "type": "string" }
            },
            "required": [
                "guiName"
            ]
        },
        "GuiClickSlotStep": {
            "properties": {
                "type": { "const": "guiClickSlot" },
                "guiName": { "type": "string" },
                "slotIndex": { "type": "integer" }
            },
            "required": [
                "guiName",
                "slotIndex"
            ]
        },
        "SkillStep": {
            "properties": {
                "type": { "const": "skill" },
                "skill": { "$ref": "#/definitions/Skills" },
                "level": { "type": "integer" }
            },
            "required": [
                "skill",
                "level"
            ]
        },
        "CollectionStep": {
            "properties": {
                "type": { "const": "collection" },
                "collection": { "$ref": "#/definitions/Collections" },
                "level": { "type": "integer" }
            },
            "required": [
                "collection",
                "level"
            ]
        },
        "StoreStep": {
            "properties": {
                "type": { "const": "store" },
                "items": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/ItemIds" }
                }
            },
            "required": [
                "items"
            ]
        },
        "RetrieveStep": {
            "properties": {
                "type": { "const": "retrieve" },
                "items": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/ItemIds" }
                }
            },
            "required": [
                "items"
            ]
        },
        "ExperienceStep": {
            "properties": {
                "type": { "const": "experience" },
                "level": { "type": "integer" }
            },
            "required": [
                "level"
            ]
        },
        "ItemIds": {
            "type": "string"
        },
        "Skills": {
            "type": "string"
        },
        "Collections": {
            "type": "string"
        },
        "Enchants": {
            "type": "string"
        },
        "Reforges": {
            "type": "string"
        },
        "Area": {
            "type": "string"
        },
        "SubArea": {
            "type": "string"
        }
    }
}
